# Market Cap ë°ì´í„° ìˆ˜ì§‘ ê°€ì´ë“œ

## ğŸ“Š ê°œìš”

### í˜„ì¬ ë°ì´í„° (ëª¨ë“  í‹°ì»¤)
- **ì†ŒìŠ¤**: Yahoo Finance
- **ëŒ€ìƒ**: ì „ì²´ 3,041ê°œ í‹°ì»¤ (í•œêµ­ + ë¯¸êµ­)
- **ì œí•œ**: ì—†ìŒ (ë¬´ë£Œ)
- **ì›Œí¬í”Œë¡œìš°**: `update_all_data.yml`
- **ì‹¤í–‰**: ë§¤ì¼ 2íšŒ (í•œêµ­/ë¯¸êµ­ ì¦ì‹œ ë§ˆê° í›„)

### ê³¼ê±° ë°ì´í„° (ë¯¸êµ­ í‹°ì»¤ë§Œ)
- **ì†ŒìŠ¤**: Financial Modeling Prep API
- **ëŒ€ìƒ**: ë¯¸êµ­ ì‹œì¥ë§Œ (NASDAQ, NYSE)
- **ì œí•œ**: 250 requests/day (ë¬´ë£Œ í”Œëœ)
- **ì›Œí¬í”Œë¡œìš°**: `backfill_market_cap.yml`
- **ì‹¤í–‰**: ë§¤ì¼ 1íšŒ (UTC 09:00)

## ğŸš€ ì„¤ì • ë°©ë²•

### 1ë‹¨ê³„: í˜„ì¬ ë°ì´í„° ìˆ˜ì§‘ (ìë™ ì‹¤í–‰ ì¤‘)
âœ… **ì´ë¯¸ ì‘ë™ ì¤‘!** ë³„ë„ ì„¤ì • ë¶ˆí•„ìš”

### 2ë‹¨ê³„: ê³¼ê±° ë°ì´í„° ì±„ìš°ê¸° (ì„ íƒì‚¬í•­)

#### API í‚¤ ë°œê¸‰
1. https://financialmodelingprep.com/developer/docs/ ë°©ë¬¸
2. ë¬´ë£Œ ê°€ì…
3. API Key ë³µì‚¬

#### GitHub Secret ì¶”ê°€
```
Settings > Secrets and variables > Actions > New repository secret
Name: FMP_API_KEY
Secret: [ë°œê¸‰ë°›ì€ API í‚¤]
```

#### í™•ì¸
- Actions íƒ­ì—ì„œ "Backfill Historical Market Cap" ì›Œí¬í”Œë¡œìš° í™•ì¸
- ë§¤ì¼ ìë™ìœ¼ë¡œ ë¯¸êµ­ í‹°ì»¤ 200ê°œì”© ì²˜ë¦¬

## âš ï¸ ì¤‘ìš” ì‚¬í•­

### FMP API ì œí•œ
- **ë¯¸êµ­ ì‹œì¥ë§Œ ì§€ì›**: NASDAQ, NYSE
- **í•œêµ­ ì‹œì¥ ë¯¸ì§€ì›**: KOSPI, KOSDAQëŠ” 403 ì˜¤ë¥˜ ë°œìƒ
- **í•´ê²°**: í•œêµ­ í‹°ì»¤ëŠ” Yahoo Financeë¡œë§Œ í˜„ì¬ ë°ì´í„° ìˆ˜ì§‘

### ë°ì´í„° ìˆ˜ì§‘ ì „ëµ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ í•œêµ­ í‹°ì»¤ (KOSPI, KOSDAQ)         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ âœ… í˜„ì¬ ë°ì´í„°: Yahoo Finance   â”‚
â”‚ âŒ ê³¼ê±° ë°ì´í„°: ë¶ˆê°€ëŠ¥           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ë¯¸êµ­ í‹°ì»¤ (NASDAQ, NYSE)         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚ âœ… í˜„ì¬ ë°ì´í„°: Yahoo Finance   â”‚
â”‚ âœ… ê³¼ê±° ë°ì´í„°: FMP API         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ’» ìˆ˜ë™ ì‹¤í–‰

### í˜„ì¬ ë°ì´í„° ì—…ë°ì´íŠ¸ (ëª¨ë“  í‹°ì»¤)
```bash
python scripts/update_market_cap.py
```

### ê³¼ê±° ë°ì´í„° ì±„ìš°ê¸° (ë¯¸êµ­ í‹°ì»¤ë§Œ)
```bash
export FMP_API_KEY=your_key
npm run backfill-market-cap 0 200    # ì²« 200ê°œ
npm run backfill-market-cap 200 200  # ë‹¤ìŒ 200ê°œ
```

## ğŸ” ë¬¸ì œ í•´ê²°

### 403 Forbidden ì˜¤ë¥˜
**ì›ì¸**: FMP APIê°€ í•œêµ­ í‹°ì»¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŒ
**í•´ê²°**: ì •ìƒ ë™ì‘. ë¯¸êµ­ í‹°ì»¤ë§Œ ì²˜ë¦¬ë¨.

### API í‚¤ ì˜¤ë¥˜
**ì›ì¸**: FMP_API_KEYê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ì˜ëª»ë¨
**í•´ê²°**: GitHub Secrets í™•ì¸

### ë°ì´í„°ê°€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ
1. Actions íƒ­ì—ì„œ ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë¡œê·¸ í™•ì¸
2. `update_all_data.yml`: í˜„ì¬ ë°ì´í„° (ë§¤ì¼)
3. `backfill_market_cap.yml`: ê³¼ê±° ë°ì´í„° (ë¯¸êµ­ë§Œ)

## ğŸ“Š ì˜ˆìƒ ê²°ê³¼

### í•œêµ­ í‹°ì»¤ (`aapw.json`)
```json
{
  "backtestData": [
    {
      "date": "2025-10-30",
      "close": 42.79,
      "volume": 27351,
      "marketCap": 2450000000000  // â† Yahoo Finance (í˜„ì¬ë§Œ)
    }
  ]
}
```

### ë¯¸êµ­ í‹°ì»¤ (`aapl.json`)
```json
{
  "backtestData": [
    {
      "date": "2020-01-15",
      "close": 310.50,
      "volume": 45678900,
      "marketCap": 1350000000000  // â† FMP API (ê³¼ê±° ë°ì´í„°)
    },
    {
      "date": "2025-10-30",
      "close": 185.25,
      "volume": 52341000,
      "marketCap": 2850000000000  // â† Yahoo Finance (í˜„ì¬ ë°ì´í„°)
    }
  ]
}
```

## ğŸ› ï¸ ê´€ë ¨ íŒŒì¼
- `scripts/update_market_cap.py` - í˜„ì¬ ë°ì´í„° (Yahoo Finance)
- `tasks/backfillMarketCap.js` - ê³¼ê±° ë°ì´í„° (FMP, ë¯¸êµ­ë§Œ)
- `.github/workflows/update_all_data.yml` - ë§¤ì¼ í˜„ì¬ ë°ì´í„°
- `.github/workflows/backfill_market_cap.yml` - ë§¤ì¼ ê³¼ê±° ë°ì´í„° (ë¯¸êµ­)

